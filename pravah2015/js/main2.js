var sidebar = [
	{
		'to'   : 'home',
		'name' : 'Home'
	},
	{
		'to'   : 'about',
		'name' : 'About Us'
	},
 	{
		'to'   : 'gallery',
		'name' : 'Gallery',
		'header' : false
	},
/*	{
		'to'   : 'workshops',
		'name' : 'Workshops'
	},
 */
	{
		'to'   : 'exhibitions',
		'name' : 'Exhibitions'
	},
	{
		'to'   : 'competitions',
		'name' : 'Competitions'
	},
/*	{
		'to'   : 'schedule',
		'name' : 'Schedule'
	},
	{
		'to'   : 'sponsors',
		'name' : 'Sponsors'
	},
 */
	{
		'to'   : 'accommodation',
		'name' : 'Hospitality',
		'header' : false
	},
	{
		'to'   : 'contact',
		'name' : 'Contact Us',
		'header' : false
	},
	{
		'to'   : 'register',
		'name' : 'Register'
	},

	{
		'to'   : 'facebook_likebutton',
		'name' : '<iframe src="http://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fpravah2015&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width:100px;" allowTransparency="true"></iframe>',
		'header' : false
	}
];


var categories = {
	'Dance' : {
	},

	'Dramatics' : {
	},

	'Fine Arts' : {
	},

	'Literary' : {
	},

	'Music' : {
	},

	'Techtrix' : {
	},

	'RoboKon' : {
	},

	'Other' : {
	}
};

var contacts = [
	{
		'team'   : 'Managers',
		'name'   : 'Gyanesh Kumar',
		'mobile' : '8824 871 012',
		'fb'     : 'Gyaneshkumar93',
		'email'  : 'gyaneshkumar93@gmail.com'
	},

 	{
		'team'   : 'Managers',
		'name'   : 'Gaurav Kanthaliya',
		'mobile' : '9461 140 098',
		'fb'	 : 'gaurav.kanthaliya',
		'email'  : 'gaurav.kanthaliya@gmail.com'
	},

/*  	{
		'team'   : 'Managers',
		'name'   : 'Hardik Mathur',
		'fb'     : 'HardikMathurExclusive',
		'email'  : 'talkin_sense@live.com',
		'mobile' : '9530 000 051'
	},
 */
 	{
		'team'   : 'Managers',
		'name'   : 'Devesh Jain',
		'fb'     : 'Jaindevesh.dj007',
		'email'  : 'jaindevesh.dj@gmail.com',
		'mobile' : '9610 379 998'
	},

/*  	{
		'team'   : 'Sponsorship',
		'name'   : 'Vishwas Jain',
		'email'  : 'vishu.donny@gmail.com',
		'fb'     : 'vishwas.jain.180',
		'mobile' : '8385 888 425'
	},

	{
		'team'   : 'Sponsorship',
		'name'   : 'Praveen Bisnoi',
		'fb'     : 'prvin29',
		'email'  : '',
		'mobile' : '8385 888 425'
	},

 	{
		'team'   : 'Creatives',
		'name'   : 'Rajat Goel',
		'email'  : 'rajatgl17@gmail.com',
		'mobile' : '8384 999 7569',
		'fb'	 :	'rajatgl17'
	},

 	{
		'team'   : 'Creatives',
		'name'   : 'Subroto Biswas',
		'fb'	 : 'subroto.biswas3',
		'mobile' : '9509 743 140',
		'email'  : 'sub14biswas@gmail.com'
	},

	{
		'team'   : 'Creatives',
		'name'   : 'Hari Singh',
		'mobile' : '7737 551 411',
		'email'  : 'hari.singh@acan.in',
		'fb'     : 'hsbijarniya'
	},
	
	{
		'team'   : 'Creatives',
		'name'   : 'Milind Sharma',
		'mobile' : '7597 557 308',
		'email'  : 'milind4computing@gmail.com',
		'fb'     : '100004759695186'
	},

	{
		'team'   : 'Event Coordinators',
		'name'   : 'Gaurav Mehra',
		'fb'     : '',
		'email'  : 'urmylifeecb@gmail.com',
		'mobile' : '8947 991 627'
	},

	{
		'team'   : 'Event Coordinators',
		'name'   : 'Kartik Gautam',
		'fb'	 : 'kartik.j.gautam',
		'mobile' : '9694 516 190',
		'email'  : 'kartikgautam1994@gmail.com'
	},

	{
		'team'   : 'Event Coordinators',
		'name'   : 'Chintan Goyal',
		'mobile' : '9462 010 301',
		'fb'     : 'chintan.goyal',
		'email'  : 'chintan308@gmail.com'
	},

	{
		'team'   : 'Publicity & Media',
		'name'   : 'Dipendra Singh',
		'fb'     : 'dipendra.rathore.9216',
		'email'  : 'dipendrarathore850@gmail.com',
		'mobile' : '9610 278 811'
	},

	{
		'team'   : 'Publicity & Media',
		'name'   : 'Jai Agrawal',
		'fb'     : 'jai.agrawal.90',
		'email'  : '',
		'mobile' : '8560 860 861'
	},

	{
		'team'   : 'Publicity & Media',
		'name'   : 'Ayush Khandelwal',
		'mobile' : '9460 418 505',
		'fb'	 : 'ayush.khandelwal.503',
		'email'	 : 'khandelwalayush1610@gmail.com'
	}
 */];


var workshops = [
	{
		'name'  : 'Digital Image Processing',
		'category'   : 'Workshops',
		'pages' :{
			'Detail' : true
		}
	},

	{
		'name'  : 'Robotics',
		'category'   : 'Workshops',
		'pages' :{
			'Detail' : true
		}
	}

];

var competitions = [
	{
		'name'  : 'Bridge-o-Mania',
		'category'   : 'Techtrix',
		'pages' :{
			'Rules' : true,
			'Contact'   : true
		},
		'members' : 4
	},

	{
		'name'  : 'Card Castle',
		'category'   : 'Techtrix',
		'pages' :{
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Dancing Fingers',
		'category'   : 'Music',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Drum Charades',
		'category'   : 'Dramatics',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Fear Factor',
		'category'   : 'Other',
		'pages' : {
			'Detail' : true,
			'Contact'   : true
		}
	},
/*
	{
		'name'  : 'Folk Dance',
		'category'   : 'Dance',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},
*/
/*	{
		'name'  : 'IRC',
		'category'   : 'RoboKon',
		'pages' : {
			'Detail': true,
			'Contact'   : true
		}
	},

*/	{
		'name'  : 'Junkyard Wars',
		'category'   : 'RoboKon',
		'pages' : {
			'Detail': true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Kavyanjali',
		'category'   : 'Literary',
		'pages' : {
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Nukkad Natak',
		'category'   : 'Dramatics',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Papperaazi',
		'category'   : 'Techtrix',
		'pages' :{
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Pirates War',
		'category'   : 'RoboKon',
		'pages' : {
			'Detail': true,
			'Rules': true,
			'Dimentions': true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Rangmanch',
		'category'   : 'Dramatics',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Rangrez',
		'category'   : 'Fine Arts',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Robo-Soccer',
		'category'   : 'RoboKon',
		'pages' : {
			'Detail': true,
			'Contact'   : true
		}
	},

/*	{
		'name'  : 'Scholastics',
		'category'   : 'RoboKon',
		'pages' : {
			'Detail': true,
			'Contact'   : true
		}
	},


*/	{
		'name'  : 'Shades',
		'category'   : 'Fine Arts',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Streetz',
		'category'   : 'Dance',
		'pages' :{
			'Detail' : true,
			'Rules'  : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Straw Scrapper',
		'category'   : 'Techtrix',
		'pages' :{
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Sur',
		'category'   : 'Music',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Symphony',
		'category'   : 'Music',
		'pages' : {
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	},

	{
		'name'  : 'Thirak',
		'category'   : 'Dance',
		'pages' :{
			'Detail' : true,
			'Rules' : true,
			'Contact'   : true
		}
	}
];



var sponsors = [
	{
		'img'  : 'myfm',
		'type' : 'Radio Partner',
		'category' : 'Associate Sponsors'
	}
];


function formatMobile( mobile_number ) {
	
}



function showWorkshops(){
}

function showEventList( category ) {
	$('.event_list').hide('blind', function () {
		$(this).remove();
	});

	var eventList = $('<div class="event_list"></div>').hide();

	for(var index in competitions) {
		if (competitions[index].category == category) {
			eventList.append(
				$('<div event_id="'+ index +'">'+ competitions[index].name +'</div>').on('click', function(){
					showEventDetail( +$(this).attr('event_id') );
				})
			);
		}
	}

	$(window.navigator.userAgent.match(/mobile|tablet/i) || $(window).height() >= $(window).width() ? ('.competitions_list div.event_category.'+ category) : '.competitions_list' ).after( eventList );
	$('.event_detail').load('pages/competitions_about.html');
	$('.event_list').show('blind');
}



function showEventDetail( event_id ) {
	var event = competitions[event_id], default_page;

	$('.event_title div.text').text( event.name );
	$('.event_title').show();

	$('.event_tabs').html('');

	for (var page in event.pages) {
		if (!default_page) default_page = page;

		$('.event_tabs').append(
			$('<div event_id='+ event_id +' page="'+ page +'">'+ page +'</div>').on('click', function() {
				$('.event_tabs > div').removeClass('bold');
				$(this).addClass('bold');

				var event = competitions[ +$(this).attr('event_id') ];
				var page  = $(this).attr('page');

				$('.event_detail').html('').load('pages/'+ (event.name +'_'+ page).toLowerCase().replace(/ /g, '_') +'.html', function(){
					if ($(window).height()-85 > $('.event_description').height())
						$('.event_description').css('margin-top', ($(window).height()- 85 - $('.event_description').height())*0.5 + 'px');
					else
						$('.event_description').css('margin-top', '');
				});
			})
		);
	}

	$('.event_tabs').show('blind', 500);
	$('.event_body, .event_description').show();
	$('.event_tabs > div[page="'+ default_page +'"]').trigger('click');
}



function autoAdjust(){
	if( window.navigator.userAgent.match(/mobile|tablet/i) || $(window).height() >= $(window).width() ) {
		$('.event_description').css('min-width', '0');
		$('.competitions_list').css('margin', '60px 0px 40px 0px');
		$('#pravah').css('margin', '-100px 0 0 -150px');
		$('#menubar').css('background', 'rgba(0,0,0,0.8)');
		$('#menubar, #text, #timer').hide('blind', 500);
		$('#panel').animate({'left':'0'}, 500);
		$('#toolbar').show('blind', 500);
		return true;
	}

	if( $(window).height() < $(window).width()) {
		$('.event_description').css('min-width', '355px');
		$('.competitions_list').css('margin', '30px 0px 30px 0px');
		$('#pravah').css('margin', '-200px 0 0 -300px');
		$('#menubar').css('background', 'transparent');
		$('#menubar, #text, #timer').show('blind', 500);
		$('#panel').animate({'left':'180px'}, 500);
		$('#toolbar').hide('blind', 500);
		return true;
	}
}

function loadPage( hash ) {
	var animation_name = ['blind', 'clip', 'drop', 'fold', 'puff', 'scale', 'size', 'slide'][Math.floor(Math.random()*8)];

	$('li.highlight').removeClass('highlight');

	$('#panel').hide(animation_name, {'complete': function(){
		$('.content_box').hide();

		path = hash.split("/");

		for(var index in path){
			var page = path[index];

			// 
			if (index==0) {
				if (page == 'home'){
					$('li[to="home"]').hide('blind', 500);
				}
				else
				{
					$('li[to="home"]').show('blind', 500);

					$('.'+ page +'.content_box').show();
					$('#panel').show(animation_name, 500);
					$('li[to="'+ page +'"]').addClass('highlight', 500);
				}


				if (page == 'about') {
					$('#content2.content_box.about').load('pages/about.html');
				}

				if (page == 'accommodation') {
					$('#content2.content_box.accommodation').load('pages/accommodation.html');
				}

				if (page == 'competitions') {
					$('#content2 > .event_detail').load('pages/competitions_about.html');
				}

				if (page == 'exhibitions') {
					$('#exhibition_content').load('pages/exhibition_about.html');
				}
				if (page == 'workshops') {
					$('#workshop_content').load('pages/digital_image_processing_detail.html');
				}
			}

			// competition event
			if (index==1) {
				$('li[event_id="'+ page +'"]').trigger('click');
			}

			// competition tabs
			if (index==2) {
				$('div[page="'+ page +'"]').trigger('click');
			}
		}
	}}, 500);
}

$(function() {
	$('.event_title').on('click', function(){
		$('.event_body').hide();
	});


	// NEW
	for(var index in categories) {
		$('#competitions').append(
				'<div id="competitions_category" competitions_category="'+ index +'">' +
					'<div id="competitions_category_title">'+ index +'</div>' +
					'<ul id="competitions_category_events"></ul>' +
				'</div>'
			);
	}
	for(var index in competitions) {
		$('#competitions > #competitions_category[competitions_category="'+ competitions[index].category +'"] > ul#competitions_category_events').append(
			$('<li event_id="'+ index +'">'+ competitions[index].name +'</li>').on('click', function(){
				showEventDetail( +$(this).attr('event_id') );
			})
		);

/* 		if (competitions[index].category == category) {
			eventList.append(
				$('<div event_id="'+ index +'">'+ competitions[index].name +'</div>').on('click', function(){
					showEventDetail( +$(this).attr('event_id') );
				})
			);
		}
 */	}


	// change current location
	$(window).on('hashchange', function () {
		if ( !window.location.hash ) window.location.hash = 'home'; 

		loadPage( window.location.hash.slice(1) );
	});

	$('#drawer').on('click', function(){
		$('#menubar').css('z-index', 5000).toggle('blind', 500);
	});

/* 	for(var index in categories) {
		$('.competitions_list').append('<div class="event_category '+ index +'" event_category="'+ index +'">'+ index +'</div>');
	}
 */
	for(var index in sidebar) {
		$('#sidebar').append('<li to="'+ sidebar[index].to +'" class="sidebar_child '+ sidebar[index].to +'"><a href="#'+ sidebar[index].to +'">'+ sidebar[index].name +'</a></li>');
	}

	var lastCategory;
	for(var index in sponsors) {
		if (lastCategory != sponsors[index].category) {
			lastCategory = sponsors[index].category;
			$('#sponsors').append('<h2 id="sponsors_team">'+ sponsors[index].category +'</h2>');
		}

		$('#sponsors').append('<div class="sponsor_box"><div class="sponsor_name">'+ sponsors[index].type +'</div><div style="background: url(images/sponsors/'+ sponsors[index].img +'.png);" class="sponsor_image"></div></div>');
	}

	var lastTeam;
	for(var index in contacts) {
		if (lastTeam != contacts[index].team) {
			lastTeam = contacts[index].team;
			$('#contacts').append('<h2 id="contact_team">'+ contacts[index].team +'</h2>');
		}

		$('#contacts').append('<div contact_id='+ index +' class="contact_box"><div style="background: url(images/contact/'+ contacts[index].name.replace(/ /g, '_').toLowerCase() +'.jpg);" class="contact_image"><div class="contact_phone"></div><div class="contact_email"></div></div><div class="contact_name">'+ contacts[index].name +'</div><div class="contact_mobile">'+ (contacts[index].email || (contacts[index].mobile ? ('+91 ' + contacts[index].mobile) : '') || '-') +'</div></div>');
	}

	$('ul#sidebar > li').on('click', function(){
		autoAdjust();

		if ($(this).attr('to')=='gallery'){ window.open('gallery','_self'); return false; }
		if ($(this).attr('to')=='register'){ window.open('register','_self'); return false; }

		window.location.hash = $(this).attr('to');

		return false;
	});


	// load coordinator's face book profile
	$('.contact_name').on('click', function(){
		window.open('https://www.facebook.com/'+ contacts[+$(this).parent().attr('contact_id')].fb, '_blank');
	});


	// toggle between email & mobile
	$('.contact_phone').click(function(){
		var contact = contacts[ +$(this).parent().parent().attr('contact_id') ];

		$(this).parent().parent().children('.contact_mobile').text( (contact.mobile ? ('+91 ' + contact.mobile) : '') || '-' );

		return false;
	});
	$('.contact_email').on('click', function(){
		var contact = contacts[ +$(this).parent().parent().attr('contact_id') ];

		$(this).parent().parent().children('.contact_mobile').text( contacts[ +$(this).parent().parent().attr('contact_id') ].email || '-' );

		return false;
	});


	// show category detailed competitions list
	$('.event_category').click(function(){
		$('.event_list, .event_tabs, .event_title').hide('blind', 500);
		showEventList( $(this).attr('event_category') );
		$('.event_list').show('blind', 500);
	});

	$('.event_list, .event_tabs, .event_title').hide();

	if ( !window.location.hash ) window.location.hash = 'home'; 
	loadPage( window.location.hash.slice(1) );


	$(window).resize( autoAdjust );
	autoAdjust();

	$('[competitions_category]').hover(function(){
		$(this).animate({'border-radius':'-=30%'}, 500);
	},function(){
		$(this).animate({'border-radius':'+=30%'}, 500);
	});

	$(window).on('keydown', function(e){
		if (e.keyCode==27) $('.event_title').trigger('click');
	});

});